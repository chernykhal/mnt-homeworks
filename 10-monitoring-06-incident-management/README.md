# Домашнее задание к занятию "10.06. Инцидент-менеджмент"
## Краткое описание инцидента
___
**21 окт. 2018 22:52** 
Затронуты некоторые службы GitHub в связи с проблемой на сетевых разделах и последующего сбоя на БД. 
В результате возникла несогласованность информации на сервисах (данных). 
Произошла деградация сервиса в течение 24 часов и 11 минут.
___
## Предшествующие события
___
Потеря соединения на 1000Гб оптическом канале связи между ХАБом US West Coast и Основным ЦОДом US East Coast data center.
___
## Причина инцидента
___
Потеря соединения на оптическом канале связи между ХАБом US West Coast и Основным ЦОДом US East Coast data center привело к рассогласованности кластеров MySQL.
___
## Воздействие
___
Несогласованность предоставляемой информации (отображение устаревшей информации). Невозможность работы событий веб-хуков и недоступность работы страниц GitHub.
___
## Обнаружение
___
Обнаружено инженерами обрабатывающими оповещения мониторинга
___
## Реакция
___
Деградация сервиса в течение 24 часов и 11 минут
___
## Восстановление
___
Восстановление полной производительности было выполнено за счет восстановления данных из бэкапов и повторных репликаций всех имеющихся данных с хостов с актуальными данными для восстановления 100% целостности данных во всех кластерах хранения данных.
___
## Таймлайн
___
**2018.10.21 22:52 UTC** - Потеря консенсуса между серверами в дата-хабах в результате описанного инцидента. После восстановления была попытка восстановления целостности кластера, восстановления консенсуса, но данные в БД различались, что привело к несогласованности в рамках кластера;

**2018.10.21 22:54 UTC** - Мониторинг генерировал оповещения, инженеры поддержки обрабатывали оповещения, в 23:02 обнаружили несоответствие статуса кластера ожидаемому. Выявлено отсутствие серверов из US East Coast;

**2018.10.21 23:07 UTC** - Отключены внутренние инструменты развертывания для предотвращения дополнительных изменений. Сайт переведен в желтый статус и автоматически зафиксирован инцидент в системе управления сбоями;

**2018.10.21 23:13 UTC** - После выявления воздействия сервера, привлечены дополнительные инженеры, выполнены действия для сохранения пользовательских данных. Но деградация системы не была остановлена;

**2018.10.21 23:19 UTC** - Были остановлены некоторые процессы (принудительная деградация системы) с целью повышения скорости восстановления;

**2018.10.22 00:05 UTC** - Разработка плана по восстановления системы и синхронизации репликаций данных. Обновлен статус, чтобы сообщить пользователям, что мы собираемся выполнить контролируемую отработку отказа внутренней системы хранения данных;

**2018.10.22 00:41 UTC** - Запущен процесс бэкапа данных, мониторинг состояния работ;

**2018.10.22 06:51 UTC** - бэкапы US East Coast data center созданы и запущенно реплицирование с серверов в West Coast;

**2018.10.22 07:46 UTC** - Опубликована расширенная информация для пользователей;

**2018.10.22 11:12 UTC** - Восстановлены сервера в US East Coast, продолжается реплицирование. Наблюдается повышенная нагрузка при реплицировании;

**2018.10.22 13:15 UTC** - Приближались к пиковому периоду нагрузок. Увеличили количество репликаций для снятия растущей нагрузки при реплицировании;

**2018.10.22 16:24 UTC** - реплицирование синхронизировано, переключение в штатную топологию MySQL;

**2018.10.22 16:45 UTC** - После восстановления возникла необходимость балансировки нагрузки да восстановления 100% услуг клиентам. Для восстановления уже имеющихся данных пользователей включили обработку, так же подняли TTL до полного завершения и возвращения к штатной работе;

**2018.10.22 23:03 UTC** - Работа возвращена к штатному поведению.
___
## Последующие действия
___
Собранны логи по всем серверам подвергнутых сбоя, производится анализ логов для выявления запросов, которые требуется обработать в ручную и информировать пользователей о возможных проблемах.

Запланированные инициативы:
- Настройка конфигурации оркестратора для снижения рисков поведения вызвавшего инцидент;
- Изменить скорость сбора информации для эффективного взаимодействия, изменить способ сбора и передачи информации;
- Запланировано изменение работы систем и ЦОДов для возможности сохранения работоспособности при полной потере одного из ЦОДов в полнофункциональном состоянии, в том числе в переход на режим active/active/active;
- Так же запланирован ряд других инициатив для повышения эффективности работы системы и снижения риска потери работоспособности системы;
___
